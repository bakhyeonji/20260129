# 데일리 사주 운세 & 감정 다이어리 IA (Information Architecture) 문서

## 1. 사이트맵 (Site Map)

### 1.1 전체 구조 개요

```
데일리 사주 운세 앱
│
├─ 첫 방문 시: 사주 프로필 설정 (모달/온보딩)
│
└─ 메인 앱 구조
    ├─ / (오늘) - 기본 화면
    │   ├─ 오늘의 운세 섹션
    │   └─ 오늘의 일기 섹션
    │
    ├─ /calendar (캘린더)
    │   ├─ 월간 캘린더 뷰
    │   └─ /day/:date (특정 날짜 상세) - 모달 또는 별도 페이지
    │
    └─ /settings (설정)
        ├─ 사주 프로필 수정
        └─ 데이터 초기화
```

### 1.2 페이지 관계도

```
┌─────────────────────────────────────────────────────┐
│  첫 방문 (사주 프로필 미설정 상태)                     │
│  ┌──────────────────────────────────────┐           │
│  │  사주 프로필 설정 모달                 │           │
│  │  - 생년월일 입력                       │           │
│  │  - 출생 시간 입력                      │           │
│  │  - [저장] 버튼                         │           │
│  └──────────────────────────────────────┘           │
│                    ↓                                 │
└─────────────────────────────────────────────────────┘
                     ↓
┌─────────────────────────────────────────────────────┐
│  메인 앱 영역 (Global Navigation)                     │
├─────────────────────────────────────────────────────┤
│  Header: 앱 타이틀 (좌) / 설정 아이콘 (우)             │
├─────────────────────────────────────────────────────┤
│                                                      │
│  ┌────────────┬────────────┬────────────┐          │
│  │   오늘     │  캘린더    │   설정     │ ← 하단 네비게이션
│  └────────────┴────────────┴────────────┘          │
│       ↑            ↑            ↑                   │
│       │            │            │                   │
│  ┌────┴────┐  ┌───┴────┐  ┌───┴────┐              │
│  │ Today   │  │Calendar│  │Settings│              │
│  │  Page   │  │  Page  │  │  Page  │              │
│  └─────────┘  └────────┘  └────────┘              │
│                    │                                │
│                    └─→ Day Detail (모달 또는 페이지) │
└─────────────────────────────────────────────────────┘
```

---

## 2. 사용자 플로우 (User Flow)

### 2.1 첫 방문 사용자 플로우

```
[앱 접속]
    ↓
[사주 프로필 존재 여부 체크]
    ↓
[없음] → [사주 프로필 설정 모달 표시]
    ↓
[생년월일 입력] (YYYY-MM-DD 형식)
    ↓
[출생 시간 입력] (HH:MM 형식, 24시간)
    ↓
[(선택적) 양력/음력 구분] - v1에서는 양력만
    ↓
[저장 버튼 클릭]
    ↓
[로딩 인디케이터 표시]
    ↓
[사주 계산 및 Supabase에 저장]
    ↓
[완료 메시지 표시] ("프로필이 저장되었습니다!")
    ↓
[오늘 페이지로 자동 이동]
    ↓
[오늘의 운세 자동 생성 시작]
```

### 2.2 일상적 사용자 플로우 (아침: 운세 확인)

```
[앱 열기]
    ↓
[오늘 페이지 로드]
    ↓
[DB에서 오늘 날짜 운세 조회]
    ↓
    ├─ [있음] → [캐시된 운세 즉시 표시]
    │                ↓
    │         [운세 내용 읽기]
    │                ↓
    │         [행운의 색상/숫자 확인]
    │                ↓
    │         [앱 종료 또는 다른 탭 이동]
    │
    └─ [없음] → [LLM API 호출하여 운세 생성]
                     ↓
              [로딩 인디케이터 표시]
                     ↓
              [생성된 운세 DB에 저장]
                     ↓
              [운세 화면에 표시]
                     ↓
              [운세 내용 읽기]
                     ↓
              [앱 종료 또는 다른 탭 이동]
```

### 2.3 일상적 사용자 플로우 (저녁: 일기 기록)

```
[앱 열기]
    ↓
[오늘 페이지 로드]
    ↓
[운세는 이미 캐시되어 있음 → 즉시 표시]
    ↓
[스크롤하여 일기 섹션으로 이동]
    ↓
[사진 업로드 영역 클릭]
    ↓
[파일 선택 대화상자 열림]
    ↓
[사진 1장 선택]
    ↓
[이미지 미리보기 표시]
    ↓
[감정 아이콘 5개 중 1개 선택]
    ↓
[선택된 아이콘 시각적 피드백 (확대, 색상 변화)]
    ↓
[저장 버튼 활성화 확인]
    ↓
[저장 버튼 클릭]
    ↓
[로딩 인디케이터 표시]
    ↓
[Supabase Storage에 사진 업로드]
    ↓
[DB에 일기 데이터 저장 (photo_url, emotion, date)]
    ↓
[성공 토스트 메시지] ("기록되었습니다!")
    ↓
[페이지 유지 또는 앱 종료]
```

### 2.4 히스토리 확인 플로우

```
[캘린더 탭 클릭]
    ↓
[캘린더 페이지 로드]
    ↓
[현재 월의 데이터 fetch]
    ↓
[각 날짜에 인디케이터 표시]
    - ⭐: 운세 있음
    - 😄/🙂/😐/😞/😢: 일기의 감정 아이콘
    ↓
[특정 날짜 클릭]
    ↓
[Day Detail 모달 열림]
    ↓
[해당 날짜의 운세 + 사진 + 감정 표시]
    ↓
[내용 확인]
    ↓
[모달 닫기 (X 버튼 또는 바깥 영역 클릭)]
    ↓
[캘린더 뷰로 복귀]
```

### 2.5 설정 수정 플로우

```
[설정 탭 클릭]
    ↓
[설정 페이지 로드]
    ↓
    ├─ [사주 프로필 수정 선택]
    │       ↓
    │  [경고 메시지 표시]
    │  ("운세 내용이 변경될 수 있습니다")
    │       ↓
    │  [확인 → 생년월일시 입력 폼 표시]
    │       ↓
    │  [수정 후 저장]
    │       ↓
    │  [DB 업데이트]
    │       ↓
    │  [완료 메시지]
    │       ↓
    │  [오늘 페이지로 이동]
    │
    └─ [데이터 초기화 선택]
            ↓
       [1차 확인 대화상자]
       ("정말로 삭제하시겠습니까?")
            ↓
       [확인 → 2차 확인 대화상자]
       ("복구할 수 없습니다. 계속하시겠습니까?")
            ↓
       [확인 → 모든 데이터 삭제]
       - Supabase DB 레코드 삭제
       - Supabase Storage 사진 삭제
            ↓
       [완료 메시지]
            ↓
       [첫 방문 상태로 복귀]
       (사주 프로필 설정 모달 표시)
```

---

## 3. 네비게이션 구조 (Navigation Structure)

### 3.1 글로벌 네비게이션

**위치**: 화면 하단 고정 (Bottom Navigation Bar)

**구성 요소**:
```
┌────────────────────────────────────────┐
│                                        │
│          [Main Content Area]           │
│                                        │
└────────────────────────────────────────┘
┌────────────────────────────────────────┐
│  [  오늘  ]  [ 캘린더 ]  [  설정  ]   │ ← Bottom Nav
└────────────────────────────────────────┘
```

**네비게이션 항목**:
1. **오늘** (홈 아이콘 + 텍스트)
   - 경로: `/`
   - 활성 상태: 채워진 아이콘 + 굵은 텍스트

2. **캘린더** (달력 아이콘 + 텍스트)
   - 경로: `/calendar`
   - 활성 상태: 채워진 아이콘 + 굵은 텍스트

3. **설정** (톱니바퀴 아이콘 + 텍스트)
   - 경로: `/settings`
   - 활성 상태: 채워진 아이콘 + 굵은 텍스트

### 3.2 상단 헤더 (Top Header)

**모바일 버전**:
```
┌────────────────────────────────────────┐
│  사주 다이어리        [설정 아이콘]     │
└────────────────────────────────────────┘
```

**데스크톱 버전**:
```
┌────────────────────────────────────────┐
│  🔮 데일리 사주 운세 & 감정 다이어리    │
│                        [설정 아이콘]    │
└────────────────────────────────────────┘
```

### 3.3 네비게이션 맵

```
┌─────────┐     ┌──────────┐     ┌─────────┐
│  오늘   │ ←→  │ 캘린더   │ ←→  │  설정   │
└─────────┘     └──────────┘     └─────────┘
                      ↓
                ┌───────────┐
                │ Day Detail│ (모달)
                └───────────┘
```

**이동 경로 설명**:
- 모든 탭은 하단 네비게이션을 통해 직접 접근 가능
- Day Detail은 캘린더에서 날짜 클릭 시에만 접근
- 설정 아이콘은 헤더에도 배치하여 어디서든 접근 가능

### 3.4 모바일 vs 데스크톱 네비게이션 차이

| 요소 | 모바일 | 데스크톱 |
|------|--------|----------|
| Bottom Navigation | 고정, 항상 표시 | 고정, 항상 표시 (중앙 정렬) |
| 헤더 | 간소화 (앱명 축약) | 전체 앱명 표시 |
| 메인 콘텐츠 영역 | 100% 너비 | 최대 800px, 중앙 정렬 |
| Day Detail 모달 | 전체 화면 | 중앙 팝업 (최대 600px) |

---

## 4. 페이지 계층 구조 (Page Hierarchy)

### 4.1 계층 다이어그램

```
Level 0 (Root)
│
├── Level 1: 오늘 페이지 (/)
│   ├── Section 1.1: 오늘의 운세
│   │   ├── 날짜 헤더
│   │   ├── 카테고리별 운세 카드
│   │   │   ├── 재물운
│   │   │   ├── 연애운
│   │   │   └── 건강운
│   │   ├── 행운 요소
│   │   │   ├── 행운의 색상
│   │   │   └── 행운의 숫자
│   │   └── 오늘의 팁
│   │
│   └── Section 1.2: 오늘의 일기
│       ├── 사진 업로드 영역
│       ├── 감정 선택 영역 (5개 아이콘)
│       └── 저장 버튼
│
├── Level 1: 캘린더 페이지 (/calendar)
│   ├── Section 2.1: 월 선택 헤더
│   │   ├── 이전 월 버튼
│   │   ├── 현재 월 표시
│   │   ├── 다음 월 버튼
│   │   └── 오늘로 이동 버튼
│   │
│   └── Section 2.2: 캘린더 그리드
│       ├── 요일 헤더 (일~토)
│       └── 날짜 셀 (최대 42개)
│           ├── 날짜 숫자
│           ├── 운세 인디케이터 (⭐)
│           └── 감정 인디케이터 (이모티콘)
│
├── Level 1: 설정 페이지 (/settings)
│   ├── Section 3.1: 사주 프로필
│   │   ├── 현재 설정된 생년월일시 표시
│   │   └── [수정] 버튼
│   │
│   ├── Section 3.2: 데이터 관리
│   │   └── [모든 데이터 삭제] 버튼 (빨간색)
│   │
│   └── Section 3.3: 앱 정보 (선택적)
│       ├── 버전 정보
│       └── 만든 사람
│
└── Level 2: Day Detail (모달) (/day/:date)
    ├── 모달 헤더
    │   ├── 날짜 표시
    │   └── [닫기] 버튼
    │
    ├── 운세 섹션
    │   ├── 카테고리별 운세
    │   ├── 행운 요소
    │   └── 팁
    │
    └── 일기 섹션
        ├── 사진 (원본 크기)
        └── 감정 아이콘 (확대)
```

### 4.2 페이지별 우선순위

| 페이지 | 우선순위 | 이유 |
|--------|----------|------|
| 오늘 | 최고 | 기본 진입점, 가장 자주 사용 |
| 캘린더 | 높음 | 주요 기능 (히스토리 확인) |
| Day Detail | 중간 | 캘린더에서만 접근, 부가 기능 |
| 설정 | 낮음 | 초기 1회 + 드문 수정 |

---

## 5. 콘텐츠 구성 (Content Organization)

### 5.1 오늘 페이지 (Today Page)

**전체 구조**:
```
┌────────────────────────────────────┐
│ Header: 앱 타이틀 / 설정 아이콘      │
├────────────────────────────────────┤
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 📅 2025년 1월 29일 목요일     │ │
│  │ 오늘의 운세                   │ │
│  └──────────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 💰 재물운                     │ │
│  │ 오늘은 예상치 못한 수입이... │ │
│  └──────────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 💕 연애운                     │ │
│  │ 소중한 사람과의 대화가...    │ │
│  └──────────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 💪 건강운                     │ │
│  │ 컨디션 관리에 신경 써야...   │ │
│  └──────────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 🎨 행운의 색상: 파란색       │ │
│  │ 🔢 행운의 숫자: 7             │ │
│  └──────────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ ⭐ 오늘의 팁                  │ │
│  │ 오후 2~4시는 중요한 결정을...│ │
│  └──────────────────────────────┘ │
│                                    │
│  ───────────────────────────────  │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 오늘 하루는 어땠나요?         │ │
│  └──────────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐ │
│  │                              │ │
│  │    [📷 사진 추가하기]        │ │
│  │                              │ │
│  └──────────────────────────────┘ │
│                                    │
│  😄   🙂   😐   😞   😢          │
│  └─────────────────────────────┘  │
│                                    │
│       [  저장하기  ]               │
│                                    │
├────────────────────────────────────┤
│  [오늘] [캘린더] [설정]            │
└────────────────────────────────────┘
```

**콘텐츠 블록 상세**:

1. **날짜 헤더**
   - 내용: YYYY년 MM월 DD일 요일
   - 스타일: 큰 폰트, 중앙 정렬

2. **운세 카테고리 카드** (3개)
   - 재물운: 💰 아이콘 + 제목 + 2~3문장
   - 연애운: 💕 아이콘 + 제목 + 2~3문장
   - 건강운: 💪 아이콘 + 제목 + 2~3문장
   - 스타일: 카드 형태, 그림자 효과, 여백

3. **행운 요소 박스**
   - 행운의 색상: 색상 칩 + 색상명
   - 행운의 숫자: 큰 숫자 + 설명
   - 스타일: 가로 배치, 아이콘 강조

4. **오늘의 팁**
   - 내용: 구체적인 시간대 또는 행동 조언
   - 스타일: 별 아이콘, 강조 박스

5. **일기 섹션 구분선**
   - 시각적 구분을 위한 수평선

6. **사진 업로드 영역**
   - 기본 상태: 점선 테두리, "사진 추가하기" 텍스트
   - 업로드 후: 이미지 미리보기 + 변경 버튼

7. **감정 선택기**
   - 5개 이모티콘 가로 나열
   - 선택 시 확대 + 색상 변화 효과

8. **저장 버튼**
   - 활성화 조건: 사진 또는 감정 중 하나 이상 선택
   - 비활성 상태: 회색, 클릭 불가
   - 활성 상태: 파란색, 클릭 가능

### 5.2 캘린더 페이지 (Calendar Page)

**전체 구조**:
```
┌────────────────────────────────────┐
│ Header: 앱 타이틀 / 설정 아이콘      │
├────────────────────────────────────┤
│                                    │
│  ┌──────────────────────────────┐ │
│  │ ←  2025년 1월  →   [오늘]   │ │
│  └──────────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 일 월 화 수 목 금 토         │ │
│  ├──────────────────────────────┤ │
│  │ 29 30 31  1  2  3  4         │ │
│  │          ⭐                   │ │
│  │  5  6  7  8  9 10 11         │ │
│  │    😄⭐     ⭐                │ │
│  │ 12 13 14 15 16 17 18         │ │
│  │    🙂⭐ 😐⭐                   │ │
│  │ 19 20 21 22 23 24 25         │ │
│  │                              │ │
│  │ 26 27 28 29 30 31  1         │ │
│  │                ⭐😊           │ │
│  └──────────────────────────────┘ │
│                                    │
├────────────────────────────────────┤
│  [오늘] [캘린더] [설정]            │
└────────────────────────────────────┘
```

**콘텐츠 블록 상세**:

1. **월 네비게이션 헤더**
   - 이전 월 버튼: ← 화살표
   - 현재 월 표시: YYYY년 M월 (중앙, 큰 폰트)
   - 다음 월 버튼: → 화살표
   - 오늘로 이동 버튼: [오늘] (우측)

2. **요일 헤더**
   - 일~토 표시
   - 일요일: 빨간색, 토요일: 파란색

3. **날짜 셀**
   - 날짜 숫자 (상단)
   - 인디케이터 (하단):
     - ⭐: 운세 있음
     - 😄/🙂/😐/😞/😢: 감정 아이콘 (일기 있음)
   - 상태별 스타일:
     - 과거: 회색 계열
     - 오늘: 진한 테두리 또는 배경색
     - 미래: 비활성화 (클릭 불가)
     - 데이터 있는 날: 강조 표시

### 5.3 Day Detail (모달)

**전체 구조**:
```
┌────────────────────────────────────┐
│                                  X │
│  2025년 1월 15일 수요일             │
├────────────────────────────────────┤
│                                    │
│  [오늘의 운세]                     │
│                                    │
│  💰 재물운                          │
│  오늘은 예상치 못한...              │
│                                    │
│  💕 연애운                          │
│  소중한 사람과의...                 │
│                                    │
│  💪 건강운                          │
│  컨디션 관리에...                   │
│                                    │
│  🎨 행운의 색상: 파란색             │
│  🔢 행운의 숫자: 7                  │
│                                    │
│  ⭐ 오늘의 팁                       │
│  오후 2~4시는...                    │
│                                    │
│  ───────────────────────────────   │
│                                    │
│  [그날의 기록]                      │
│                                    │
│  ┌──────────────────────────────┐ │
│  │                              │ │
│  │      [업로드한 사진 표시]     │ │
│  │                              │ │
│  └──────────────────────────────┘ │
│                                    │
│         😄 (매우 좋음)              │
│                                    │
└────────────────────────────────────┘
```

**콘텐츠 블록 상세**:

1. **모달 헤더**
   - 날짜: 상단 중앙
   - 닫기 버튼: 우상단 X 아이콘

2. **운세 섹션**
   - 오늘 페이지와 동일한 구조
   - 과거 데이터이므로 편집 불가

3. **일기 섹션**
   - 사진: 원본 크기, 중앙 정렬
   - 감정 아이콘: 확대 표시, 중앙 정렬
   - 없는 경우: "기록이 없습니다" 메시지

### 5.4 설정 페이지 (Settings Page)

**전체 구조**:
```
┌────────────────────────────────────┐
│ Header: 설정                        │
├────────────────────────────────────┤
│                                    │
│  [사주 프로필]                      │
│                                    │
│  생년월일: 1996년 3월 15일          │
│  출생 시간: 09:30                   │
│                                    │
│       [  수정하기  ]                │
│                                    │
│  ───────────────────────────────   │
│                                    │
│  [데이터 관리]                      │
│                                    │
│    ⚠️ [모든 데이터 삭제] ⚠️         │
│                                    │
│  ───────────────────────────────   │
│                                    │
│  [앱 정보]                          │
│                                    │
│  버전: 1.0.0                        │
│                                    │
├────────────────────────────────────┤
│  [오늘] [캘린더] [설정]            │
└────────────────────────────────────┘
```

**콘텐츠 블록 상세**:

1. **사주 프로필 섹션**
   - 현재 설정 표시 (읽기 전용)
   - 수정 버튼

2. **데이터 관리 섹션**
   - 삭제 버튼 (빨간색, 경고 아이콘)

3. **앱 정보 섹션** (선택적)
   - 버전, 제작자 등

---

## 6. 인터랙션 패턴 (Interaction Patterns)

### 6.1 운세 생성 및 캐싱 로직

**상태 다이어그램**:
```
[앱 로드]
    ↓
[오늘 날짜 확인: YYYY-MM-DD]
    ↓
[DB 쿼리: SELECT * FROM daily_fortunes WHERE date = today]
    ↓
    ├─ [결과 있음]
    │      ↓
    │  [캐시된 운세 표시]
    │  [로딩 시간: ~100ms]
    │  [LLM 호출: 없음 ✓]
    │
    └─ [결과 없음]
           ↓
       [로딩 인디케이터 표시]
           ↓
       [사주 프로필 조회]
           ↓
       [LLM API 호출]
       [입력: 사주 데이터 + 오늘 날짜]
           ↓
       [운세 텍스트 생성]
       [예상 시간: 3~5초]
           ↓
       [DB에 저장]
       [INSERT INTO daily_fortunes ...]
           ↓
       [화면에 운세 표시]
       [로딩 인디케이터 숨김]
```

**하루에 여러 번 접속 시**:
- 첫 접속: LLM 호출 → 운세 생성 → DB 저장
- 재접속: DB 조회만 → 즉시 표시
- 토큰 절약률: ~95% (하루 1회만 호출)

### 6.2 감정 선택 인터랙션

**기본 상태**:
```
😄   🙂   😐   😞   😢
```

**호버 상태** (데스크톱):
```
😄   🙂   😐   😞   😢
 ↑
커서
(약간 확대)
```

**선택 상태**:
```
😄   🙂   😐   😞   😢
 ↑
선택됨
(크기 1.3배, 색상 강조, 애니메이션)
```

**전환 애니메이션**:
- 이전 선택 → 축소 (0.3초)
- 새 선택 → 확대 (0.3초)

### 6.3 사진 업로드 인터랙션

**상태 흐름**:
```
[초기 상태]
┌──────────────────┐
│   📷 사진 추가   │ ← 클릭
└──────────────────┘
        ↓
[파일 선택 대화상자]
        ↓
[사진 선택]
        ↓
[업로드 중 상태]
┌──────────────────┐
│   ⏳ 업로드 중   │
│   [Progress Bar] │
└──────────────────┘
        ↓
[업로드 완료 상태]
┌──────────────────┐
│  [이미지 미리보기]│
│   [🔄 변경하기]  │
└──────────────────┘
```

**드래그 앤 드롭** (데스크톱):
- 드래그 오버 시: 점선 테두리 강조
- 드롭 시: 자동 업로드 시작

### 6.4 캘린더 날짜 선택 인터랙션

**날짜 셀 상태**:

| 상태 | 시각적 표현 | 인터랙션 |
|------|------------|----------|
| 미래 날짜 | 회색, 흐림 | 클릭 불가 |
| 오늘 | 굵은 테두리 | 클릭 가능 (자신의 상세로) |
| 과거 (데이터 없음) | 기본 스타일 | 클릭 불가 또는 "데이터 없음" 표시 |
| 과거 (운세만) | ⭐ 표시 | 클릭 → Day Detail 모달 |
| 과거 (일기만) | 😄 표시 | 클릭 → Day Detail 모달 |
| 과거 (둘 다) | ⭐😄 표시 | 클릭 → Day Detail 모달 |

**클릭 후 동작**:
```
[날짜 클릭]
    ↓
[해당 날짜 데이터 fetch]
    ↓
[Day Detail 모달 열림]
(페이드 인 애니메이션 0.3초)
    ↓
[모달 내용 표시]
```

### 6.5 설정 수정 인터랙션

**사주 프로필 수정**:
```
[수정하기 버튼 클릭]
    ↓
[경고 대화상자]
┌─────────────────────────────┐
│ ⚠️ 주의                      │
│                             │
│ 생년월일시를 변경하면        │
│ 모든 운세 내용이 변경됩니다. │
│                             │
│  [취소]      [계속]         │
└─────────────────────────────┘
    ↓ [계속 선택]
[입력 폼 표시]
(기존 값 미리 채워짐)
    ↓
[수정 후 저장]
    ↓
[DB 업데이트]
    ↓
[완료 토스트 메시지]
```

**데이터 삭제**:
```
[모든 데이터 삭제 버튼 클릭]
    ↓
[1차 확인 대화상자]
┌─────────────────────────────┐
│ 정말로 삭제하시겠습니까?     │
│                             │
│  [취소]      [확인]         │
└─────────────────────────────┘
    ↓ [확인 선택]
[2차 확인 대화상자]
┌─────────────────────────────┐
│ ⚠️ 경고                      │
│                             │
│ 모든 데이터가 영구적으로     │
│ 삭제됩니다.                  │
│ 복구할 수 없습니다.          │
│                             │
│  [취소]      [삭제]         │
└─────────────────────────────┘
    ↓ [삭제 선택]
[삭제 진행 중...]
(프로그레스 인디케이터)
    ↓
[완료]
    ↓
[첫 방문 상태로 전환]
(사주 프로필 설정 모달)
```

### 6.6 상태별 UI 처리

**로딩 상태**:
- 스켈레톤 UI 사용 (운세 카드 영역)
- 스피너 + 텍스트 ("운세 생성 중...")
- 사용자 상호작용 비활성화

**에러 상태**:
- 에러 메시지 표시
- 재시도 버튼 제공
- 예시: "운세를 불러올 수 없습니다. [다시 시도]"

**빈 상태**:
- 일기 미작성: "오늘의 기록을 남겨보세요"
- 과거 데이터 없음: "아직 기록이 없습니다"

---

## 7. URL 구조 (URL Structure)

### 7.1 전체 URL 맵

```
/ (루트)
├── /                    → 오늘 페이지 (Today)
├── /calendar            → 캘린더 페이지
│   └── /day/:date       → 특정 날짜 상세 (모달 또는 페이지)
│                           예: /day/2025-01-15
└── /settings            → 설정 페이지
```

### 7.2 URL 패턴 상세

| URL | 페이지 | 설명 | 예시 |
|-----|--------|------|------|
| `/` | 오늘 | 기본 진입점, 오늘의 운세 + 일기 | `/` |
| `/calendar` | 캘린더 | 월간 캘린더 뷰 | `/calendar` |
| `/calendar?month=2025-01` | 캘린더 (특정 월) | 쿼리로 월 지정 가능 | `/calendar?month=2024-12` |
| `/day/:date` | Day Detail | 특정 날짜 상세 (YYYY-MM-DD) | `/day/2025-01-15` |
| `/settings` | 설정 | 사주 프로필 수정, 데이터 관리 | `/settings` |

### 7.3 URL 설계 원칙

1. **간결성**: 최소한의 경로만 사용
2. **의미성**: URL만 봐도 페이지 내용 추론 가능
3. **일관성**: 날짜 형식 통일 (YYYY-MM-DD)
4. **확장성**: 향후 기능 추가 시 충돌 없도록

### 7.4 라우팅 전략

**Next.js 파일 구조 (App Router 기준)**:
```
/app
  /page.tsx              → /
  /calendar
    /page.tsx            → /calendar
  /day
    /[date]
      /page.tsx          → /day/:date
  /settings
    /page.tsx            → /settings
```

**대체 방안** (Day Detail을 모달로 처리 시):
```
/app
  /page.tsx              → /
  /calendar
    /page.tsx            → /calendar (+ 클라이언트 모달)
  /settings
    /page.tsx            → /settings
```

### 7.5 네비게이션 동작

**클라이언트 사이드 라우팅**:
- 모든 페이지 전환은 SPA 방식
- 부드러운 전환 애니메이션
- 브라우저 뒤로/앞으로 지원

**직접 URL 접근**:
- `/`: 항상 접근 가능
- `/calendar`: 항상 접근 가능
- `/day/2025-01-15`: 해당 날짜 데이터 있으면 표시, 없으면 404 또는 리다이렉트
- `/settings`: 항상 접근 가능

---

## 8. 컴포넌트 계층 구조 (Component Hierarchy)

### 8.1 전체 컴포넌트 트리

```
App
│
├── GlobalLayout
│   ├── Header
│   │   ├── AppTitle
│   │   └── SettingsIcon
│   │
│   ├── MainContent
│   │   └── [Page Components]
│   │
│   └── BottomNavigation
│       ├── NavItem (오늘)
│       ├── NavItem (캘린더)
│       └── NavItem (설정)
│
├── Pages
│   │
│   ├── TodayPage
│   │   ├── FortuneSection
│   │   │   ├── DateHeader
│   │   │   ├── FortuneCard (재물운)
│   │   │   ├── FortuneCard (연애운)
│   │   │   ├── FortuneCard (건강운)
│   │   │   ├── LuckyElements
│   │   │   │   ├── LuckyColor
│   │   │   │   └── LuckyNumber
│   │   │   └── DailyTip
│   │   │
│   │   └── DiarySection
│   │       ├── PhotoUploader
│   │       ├── EmotionPicker
│   │       │   └── EmotionIcon (x5)
│   │       └── SaveButton
│   │
│   ├── CalendarPage
│   │   ├── MonthNavigation
│   │   │   ├── PrevMonthButton
│   │   │   ├── CurrentMonthLabel
│   │   │   ├── NextMonthButton
│   │   │   └── TodayButton
│   │   │
│   │   └── CalendarGrid
│   │       ├── WeekdayHeader
│   │       └── DateCell (x 42)
│   │           ├── DateNumber
│   │           ├── FortuneIndicator (⭐)
│   │           └── EmotionIndicator
│   │
│   ├── DayDetailModal
│   │   ├── ModalOverlay
│   │   ├── ModalContent
│   │   │   ├── ModalHeader
│   │   │   │   ├── DateTitle
│   │   │   │   └── CloseButton
│   │   │   │
│   │   │   ├── FortuneSection
│   │   │   │   └── [FortuneCard 재사용]
│   │   │   │
│   │   │   └── DiaryDisplay
│   │   │       ├── PhotoDisplay
│   │   │       └── EmotionDisplay
│   │
│   └── SettingsPage
│       ├── SajuProfileSection
│       │   ├── ProfileDisplay
│       │   └── EditButton
│       │
│       ├── DataManagementSection
│       │   └── DeleteAllButton
│       │
│       └── AppInfoSection
│           └── VersionInfo
│
├── Shared Components
│   ├── FortuneCard
│   │   ├── CategoryIcon
│   │   ├── CategoryTitle
│   │   └── FortuneText
│   │
│   ├── EmotionPicker
│   │   └── EmotionIcon (x5)
│   │
│   ├── PhotoUploader
│   │   ├── UploadArea
│   │   ├── PreviewImage
│   │   └── ChangeButton
│   │
│   ├── LoadingSpinner
│   ├── Toast
│   ├── ConfirmDialog
│   └── ErrorMessage
│
└── Contexts / State Management
    ├── SajuProfileContext
    ├── TodayFortuneContext
    └── CalendarDataContext
```

### 8.2 주요 컴포넌트 상세

#### 8.2.1 Layout Components

**GlobalLayout**
- 역할: 모든 페이지의 공통 레이아웃
- Props: `children`
- State: 없음 (순수 레이아웃)

**Header**
- 역할: 상단 헤더 바
- Props: 없음
- State: 없음

**BottomNavigation**
- 역할: 하단 네비게이션 바
- Props: 없음
- State: 현재 활성 탭 (URL 기반)

#### 8.2.2 Page Components

**TodayPage**
- 역할: 오늘의 운세 + 일기 표시 및 입력
- Props: 없음
- State:
  - `fortune`: 오늘의 운세 데이터
  - `diaryPhoto`: 업로드한 사진 URL
  - `selectedEmotion`: 선택한 감정 (1~5)
  - `isLoading`: 운세 로딩 상태
- Effects:
  - 마운트 시 운세 fetch
  - 날짜 변경 감지

**CalendarPage**
- 역할: 월간 캘린더 표시
- Props: 없음
- State:
  - `currentMonth`: 현재 표시 중인 월
  - `calendarData`: 해당 월의 모든 운세/일기 데이터
  - `selectedDate`: 클릭한 날짜
  - `showDayDetail`: Day Detail 모달 표시 여부
- Effects:
  - 월 변경 시 데이터 fetch

**DayDetailModal**
- 역할: 특정 날짜의 상세 정보 표시
- Props:
  - `date`: 표시할 날짜
  - `onClose`: 닫기 핸들러
  - `isOpen`: 모달 열림 상태
- State:
  - `dayData`: 해당 날짜의 운세 + 일기 데이터

**SettingsPage**
- 역할: 설정 관리
- Props: 없음
- State:
  - `sajuProfile`: 현재 사주 프로필
  - `isEditing`: 수정 모드 여부

#### 8.2.3 Reusable Components

**FortuneCard**
- 역할: 운세 카테고리 카드 (재물/연애/건강)
- Props:
  - `category`: 카테고리 이름
  - `icon`: 아이콘
  - `text`: 운세 텍스트
- State: 없음 (순수 프레젠테이션)

**EmotionPicker**
- 역할: 5개 감정 선택
- Props:
  - `selectedEmotion`: 현재 선택된 감정
  - `onSelect`: 선택 핸들러
- State: 없음 (Controlled Component)

**PhotoUploader**
- 역할: 사진 업로드 및 미리보기
- Props:
  - `photoUrl`: 현재 사진 URL
  - `onUpload`: 업로드 핸들러
- State:
  - `isUploading`: 업로드 중 상태
  - `uploadProgress`: 업로드 진행률

**LoadingSpinner**
- 역할: 로딩 인디케이터
- Props:
  - `text`: 로딩 메시지 (선택적)
- State: 없음

**Toast**
- 역할: 알림 메시지 표시
- Props:
  - `message`: 메시지 텍스트
  - `type`: success | error | info
  - `duration`: 표시 시간 (기본 3초)
- State: `isVisible`

**ConfirmDialog**
- 역할: 확인 대화상자
- Props:
  - `title`: 제목
  - `message`: 메시지
  - `onConfirm`: 확인 핸들러
  - `onCancel`: 취소 핸들러
  - `confirmText`: 확인 버튼 텍스트
  - `cancelText`: 취소 버튼 텍스트
  - `variant`: normal | danger
- State: 없음 (Controlled)

### 8.3 상태 관리 전략

**전역 상태** (Context API 또는 Zustand):
- `SajuProfileContext`: 사주 프로필 데이터
- `TodayFortuneContext`: 오늘의 운세 캐시
- `CalendarDataContext`: 캘린더 데이터 캐시

**로컬 상태** (useState):
- 각 컴포넌트의 UI 상태
- 폼 입력 값

**서버 상태** (Supabase 직접 또는 React Query):
- DB 데이터 fetch/update
- 캐싱 및 리프레시 관리

### 8.4 컴포넌트별 LLM/캐싱 인지

| 컴포넌트 | LLM 인지 | 캐싱 인지 | 역할 |
|---------|---------|----------|------|
| TodayPage | ✅ | ✅ | 운세 fetch 로직, 로딩 상태 관리 |
| FortuneSection | ❌ | ✅ | 캐시된 운세 표시 |
| CalendarPage | ❌ | ✅ | 캐시된 데이터 표시 |
| DayDetailModal | ❌ | ✅ | 과거 캐시 데이터 표시 |

### 8.5 컴포넌트 재사용 전략

**재사용 가능**:
- `FortuneCard`: 오늘 페이지, Day Detail에서 동일하게 사용
- `EmotionIcon`: EmotionPicker, 캘린더 인디케이터, Day Detail에서 사용
- `LoadingSpinner`, `Toast`, `ConfirmDialog`: 전역적으로 사용

**재사용 불가** (페이지 특화):
- `CalendarGrid`: 캘린더 페이지 전용
- `DiarySection`: 오늘 페이지 전용

---

## 9. 반응형 디자인 전략

### 9.1 브레이크포인트

```
모바일:    < 768px
태블릿:    768px ~ 1024px
데스크톱:  > 1024px
```

### 9.2 레이아웃 변화

**오늘 페이지**:
- 모바일: 단일 컬럼, 전체 너비
- 데스크톱: 최대 800px, 중앙 정렬, 좌우 여백

**캘린더 페이지**:
- 모바일: 날짜 셀 작게, 인디케이터 최소화
- 데스크톱: 날짜 셀 크게, 더 많은 정보 표시

**Day Detail 모달**:
- 모바일: 전체 화면
- 데스크톱: 600px 너비, 중앙 팝업

### 9.3 터치/마우스 최적화

**모바일 터치**:
- 버튼 최소 크기: 44x44px
- 감정 아이콘 간격: 충분한 여백
- 스와이프 제스처: 캘린더 월 이동

**데스크톱 마우스**:
- 호버 효과: 버튼, 날짜 셀
- 커서 변경: 클릭 가능 영역
- 키보드 네비게이션: Tab 키 지원

---

## 10. 접근성 (Accessibility)

### 10.1 스크린 리더 지원

- 모든 인터랙티브 요소에 `aria-label`
- 감정 아이콘: "매우 좋음 선택", "좋음 선택" 등
- 날짜 셀: "1월 15일, 운세 있음, 일기 있음"
- 이미지: `alt` 텍스트 필수

### 10.2 키보드 네비게이션

- Tab 키로 모든 요소 접근
- Enter/Space로 버튼 활성화
- Esc 키로 모달 닫기
- 화살표 키로 캘린더 이동

### 10.3 색상 대비

- WCAG AA 기준 이상
- 행운의 색상: 텍스트로도 병기
- 감정 아이콘: 이모티콘 + 텍스트 레이블

---

## 11. 성능 최적화

### 11.1 데이터 로딩

- 오늘 페이지: 초기 로드 시 오늘 운세만
- 캘린더: 현재 월 데이터만 fetch
- Day Detail: 클릭 시 해당 날짜만 fetch

### 11.2 이미지 최적화

- 업로드 시 리사이징 (최대 1200px)
- WebP 포맷 사용
- Lazy loading (캘린더 사진 썸네일)

### 11.3 코드 스플리팅

- 페이지별 코드 분리 (Next.js 자동)
- Day Detail 모달: 동적 임포트

---

## 12. 정리 및 핵심 원칙

### 12.1 IA 설계 핵심 원칙

1. **단순성**: 3개 주요 페이지로 모든 기능 구현
2. **효율성**: LLM 토큰 절약을 위한 캐싱 전략 반영
3. **직관성**: 모바일 우선, 원핸드 조작 가능
4. **확장성**: 향후 멀티 유저 지원 가능한 구조

### 12.2 주요 디자인 결정

| 결정 사항 | 선택된 방안 | 이유 |
|----------|------------|------|
| Day Detail 표시 방법 | 모달 | 캘린더 컨텍스트 유지, 빠른 닫기 |
| 네비게이션 위치 | 하단 | 모바일 접근성, 엄지 손가락 영역 |
| URL 구조 | 간단한 경로 | 1인 사용, SEO 불필요 |
| 운세 생성 타이밍 | 첫 접속 시 | 토큰 절약, 즉시 표시 |

### 12.3 향후 고려사항

- PWA 전환: 오프라인 지원, 앱처럼 설치
- 푸시 알림: 매일 운세 확인 리마인더
- 다크 모드: 사용자 선호도 지원
- 멀티 유저: 인증 레이어 추가